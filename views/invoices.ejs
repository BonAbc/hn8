<%- include("partials/header.ejs") %>
<!--Remember this include when add a new page-->
<main class="container">
  <!--main should move to main page-->
  <!---->
  <form>
    <label for="date">Date:</label>
    <input type="date" id="date" name="date" value="<%= defaultDate %>" />
  </form>

  <!---->
  <h2 id="hm">Accounting</h2>
  <div class="invoice-container">
    <h2>Create New Invoice</h2>

    <form action="/save-invoice" method="POST">
      <!-- Company & Client -->
     <div>
        <label>Company:</label>
   <select name="company_id" required disabled >
    <!--select name="company_id" required disabled üëà-->
           <option value="">-- Select Company --</option>
          <% companies.forEach(company => { %>
          <option value="<%= company.id %>"><%= company.name %></option>
          <% }) %>
            <% companies.forEach(company => { %>
      <option value="<%= company.id %>"><%= company.name %></option>
      <% }) %>
        </select>




        <label>Client:</label>
         
        <select name="client_id" required disabled>
           <option value="">-- Select Client --</option>
          <% clients.forEach(client => { %>
          <option value="<%= client.id %>"><%= client.name %></option>
          <% }) %>
        </select>
      </div>



      <!-- Dates & Tax -->
      <div>
        <label>Due Date:</label>
        <input
          type="date"
          name="due_date"
          value="<%= defaultDate %>"
          required
        />

        <label>Tax Rate (%):</label>
        <input type="number" name="tax_rate" value="0" step="0.01" disabled />
      </div>

      <!-- Invoice Items -->
     <!-- Section for listing invoice items -->
<h3>Items</h3>

<div id="items">
  <!-- Default item row (one item to start with) -->
  <div class="item-row">
    <!-- Description field -->
    <input
      type="text"
      name="description[]"
      placeholder="Description"
      required
      readonly
    />

    <!-- Quantity field (calls calculateTotals when changed) -->
    <input
      type="number"
      name="qty[]"
      placeholder="Qty"
      required
      oninput="calculateTotals()"
      readonly
    />

    <!-- Unit price field (calls calculateTotals when changed) -->
    <input
      type="number"
      step="0.01"
      name="unit_price[]"
      placeholder="Unit Price"
      required
      oninput="calculateTotals()"
      readonly
    />

    <!-- Remove button (üóëÔ∏è) - deletes this item row -->
    <button type="button" class="remove-btn" disabled onclick="removeItem(this)">
      üóëÔ∏è Remove
    </button>
  </div>
</div>

<!-- Button to add new item rows dynamically -->
<button type="button" onclick="addItem()" disabled>+ Add Item</button>

<!-- ============================= -->
<!--          TOTALS AREA          -->
<!-- ============================= -->
<div class="totals">
  <p>Subtotal: $<span id="subtotal">0.00</span></p>
  <p>Tax: $<span id="tax">0.00</span></p>
  <h3>Total: $<span id="total">0.00</span></h3>
</div>

<!-- ============================= -->
<!--     PAYMENT INFORMATION       -->
<!-- ============================= -->
<h3>Payment Info</h3>
<div>
  <input type="text" name="bank" placeholder="Bank" required readonly/>
  <input type="text" name="account_name" placeholder="Account Name" required readonly />
  <input type="text" name="account_number" placeholder="Account Number" required readonly />
  <input type="text" name="routing" placeholder="Routing Number" required readonly/>
</div>

<br />
<button type="submit" disabled>Save Invoice</button>

<!-- ============================= -->
<!--        SCRIPT SECTION         -->
<!-- ============================= -->

<!-- Link external JS -->
<script src="/js/invoices.js"></script>
<!-- Link external JS end -->
  <!--Refer to index.ejs how to include header and footer.ejs-->
</main>

<%- include("partials/footer.ejs") %><!--Remember this include when add a new page-->